{% extends 'mcs/goat-farm/base.html' %} {% block title %}Goat Farm Dashboard -
MCS{% endblock %} {% block content %}
<div class="container py-4">
  <!-- Welcome Message -->
  <div
    class="alert mb-4"
    role="alert"
    style="background: linear-gradient(45deg, #fd7e14, #e06c0c); color: white"
  >
    <div class="d-flex align-items-center">
      <div class="flex-shrink-0">
        <i class="fas fa-user-circle fa-2x me-3"></i>
      </div>
      <div class="flex-grow-1">
        <h4 class="alert-heading mb-1 text-white">
          {{ user.username }}, You are welcome to your Commercial Goat Farming
          Project!
        </h4>
        <p class="mb-0 text-white-50">
          Track your investment progress and manage your goat farm efficiently.
        </p>
      </div>  
    </div>
  </div>

  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Commercial Goat Farming</h1>
  </div>

  <!-- Stats Overview -->
  <div class="row g-4 mb-4">
    <!-- Total Goats -->
    <div class="col-md-6 col-lg-3">
      <div class="card bg-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-subtitle mb-2 text-muted">Total Goats</h6>
              <h2 class="card-title mb-0">{{ total_goats }}</h2>
            </div>
            <div class="icon text-primary">
              <i class="fas fa-goat"></i>
            </div>
          </div>
          <p class="card-text mt-3 mb-0">
            <small class="text-muted">
              Current: {{ total_initial_female_goats }} Female; {{ total_initial_male_goats }} Male <br> 
              Offsprings: {{ total_offspring_received }}
            </small>
          </p>
        </div>
      </div>
    </div>

    <!-- Total Investment -->
    <div class="col-md-6 col-lg-3">
      <div class="card bg-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-subtitle mb-2 text-muted">Total Investment</h6>
              <h2 class="card-title mb-0">UGX {{ total_investment|floatformat:0 }}</h2>
            </div>
            <div class="icon text-primary">
              <i class="fas fa-money-bill-wave"></i>
            </div>
          </div>
          <p class="card-text mt-3 mb-0">
            <small class="text-muted">
              {% if user_investments %}
                {{ user_investments.count }} Investment{{ user_investments.count|pluralize }}
              {% else %}
                No investments yet
              {% endif %}
            </small>
          </p>
        </div>
      </div>
    </div>

    <!-- Pending Payments -->
    <div class="col-md-6 col-lg-3">
      <div class="card bg-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-subtitle mb-2 text-muted">Pending Payments</h6>
              <h2 class="card-title mb-0">UGX {{ total_pending_amount|floatformat:0 }}</h2>
            </div>
            <div class="icon text-primary">
              <i class="fas fa-clock"></i>
            </div>
          </div>
          <p class="card-text mt-3 mb-0">
            <small class="text-muted">
              Total: UGX {{ total_package_amounts|floatformat:0 }} <br> Paid: UGX {{ total_investment|floatformat:0 }}
            </small>
          </p>
        </div>
      </div>
    </div>

    <!-- Expected Returns -->
    <div class="col-md-6 col-lg-3">
      <div class="card bg-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-subtitle mb-2 text-muted">Expected Returns</h6>
              <h2 class="card-title mb-0">{{ total_expected_offspring }} Goat{{ total_expected_offspring|pluralize }}</h2>
            </div>
            <div class="icon text-primary">
              <i class="fas fa-chart-line"></i>
            </div>
          </div>
          <p class="card-text mt-3 mb-0">
            <small class="text-muted">
              {% if earliest_completion %}
                By: {{ earliest_completion|date:"M d, Y" }}
              {% else %}
                No completion date set
              {% endif %}
            </small>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="row g-4">
    <!-- Investment Details -->
    <div class="col-12">
      <div class="card bg-white h-100">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">Transaction Records</h5>
        </div>
        <div class="card-body">
          {% if investment_transactions %}
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Package</th>
                    <th>Transaction Type</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Reference</th>
                  </tr>
                </thead>
                <tbody>
                  {% for transaction in investment_transactions %}
                    <tr>
                      <td>{{ transaction.investment.package.name }}</td>
                      <td>{{ transaction.transaction_type }}</td>
                      <td>UGX {{ transaction.amount|floatformat:0 }}</td>
                      <td>
                        <span class="badge {% if transaction.status == 'completed' %}bg-success{% elif transaction.status == 'pending' %}bg-warning{% elif transaction.status == 'cancelled' %}bg-danger{% else %}bg-secondary{% endif %}">
                          {{ transaction.status|title }}
                        </span>
                      </td>
                      <td>{{ transaction.date|date:"M d, Y" }}</td>
                      <td>{{ transaction.description|truncatechars:50 }}</td>
                      <td>
                        {% if transaction.reference_number %}
                          {{ transaction.reference_number }}
                        {% else %}
                          -
                        {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="text-center py-4">
              <i class="fas fa-info-circle fa-3x text-muted mb-3"></i>
              <h5 class="text-muted">No transactions found</h5>
              <p class="text-muted">You haven't made any goat farming transactions yet.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Goat Health Status -->
    <div class="col-lg-4">
      <div class="card bg-white h-100">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">Goat Health Status</h5>
        </div>
        <div class="card-body">
          {% if total_goats > 0 %}
            <div class="row g-3">
              {% if healthy_goats > 0 %}
                <div class="col-6">
                  <div class="alert bg-light mb-0">
                    <div class="d-flex align-items-center">
                      <div class="flex-shrink-0">
                        <i class="fas fa-heartbeat text-success fa-2x"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <h6 class="mb-1">Healthy</h6>
                        <p class="mb-0">{{ healthy_goats }} goat{{ healthy_goats|pluralize }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
              
              {% if under_observation_goats > 0 %}
                <div class="col-6">
                  <div class="alert bg-light mb-0">
                    <div class="d-flex align-items-center">
                      <div class="flex-shrink-0">
                        <i class="fas fa-eye text-warning fa-2x"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <h6 class="mb-1">Under Observation</h6>
                        <p class="mb-0">{{ under_observation_goats }} goat{{ under_observation_goats|pluralize }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
              
              {% if sick_goats > 0 %}
                <div class="col-6">
                  <div class="alert bg-light mb-0">
                    <div class="d-flex align-items-center">
                      <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle text-danger fa-2x"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <h6 class="mb-1">Sick</h6>
                        <p class="mb-0">{{ sick_goats }} goat{{ sick_goats|pluralize }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
            </div>
          {% else %}
            <div class="text-center py-4">
              <i class="fas fa-goat fa-3x text-muted mb-3"></i>
              <h5 class="text-muted">No goats found</h5>
              <p class="text-muted">No goats have been assigned to your investments yet.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Pregnant Goats -->
    <div class="col-lg-4">
      <div class="card bg-white h-100">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">Pregnant Goats</h5>
        </div>
        <div class="card-body">
          {% if pregnant_goats %}
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Goat ID</th>
                    <th>Expected Date</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  {% for goat in pregnant_goats %}
                    <tr>
                      <td>{{ goat.goat_id }}</td>
                      <td>
                        {% if goat.expected_delivery_date %}
                          {{ goat.expected_delivery_date|date:"M d, Y" }}
                        {% else %}
                          Not set
                        {% endif %}
                      </td>
                      <td><span class="badge bg-info">Pregnant</span></td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="text-center py-4">
              <i class="fas fa-baby fa-3x text-muted mb-3"></i>
              <h5 class="text-muted">No pregnant goats</h5>
              <p class="text-muted">No goats are currently pregnant.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Offspring Born -->
    <div class="col-lg-4">
      <div class="card bg-white h-100">
        <div class="card-header bg-transparent">
          <h5 class="card-title mb-0">Offspring Born</h5>
        </div>
        <div class="card-body">
          {% if user_offspring %}
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Offspring ID</th>
                    <th>Mother</th>
                    <th>Gender</th>
                    <th>Birth Date</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  {% for offspring in user_offspring %}
                    <tr>
                      <td>{{ offspring.offspring_id }}</td>
                      <td>{{ offspring.mother.goat_id }}</td>
                      <td>{{ offspring.gender|title }}</td>
                      <td>{{ offspring.birth_date|date:"M d, Y" }}</td>
                      <td>
                        <span class="badge {% if offspring.is_alive %}bg-success{% else %}bg-danger{% endif %}">
                          {% if offspring.is_alive %}Alive{% else %}Deceased{% endif %}
                        </span>
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="text-center py-4">
              <i class="fas fa-baby fa-3x text-muted mb-3"></i>
              <h5 class="text-muted">No offspring born yet</h5>
              <p class="text-muted">No offspring have been recorded yet.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  // Add any dashboard-specific JavaScript here
  document.addEventListener("DOMContentLoaded", function () {
    // Initialize any charts or interactive elements
  });
</script>
{% endblock %}
